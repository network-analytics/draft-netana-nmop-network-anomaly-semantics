<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc>
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="2"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<rfc category="exp" docName="draft-ietf-nmop-network-anomaly-semantics-03"
     ipr="trust200902" submissionType="IETF">
  <front>
    <title abbrev="Network Anomaly Semantics">Semantic Metadata Annotation for
    Network Anomaly Detection</title>

    <author fullname="Thomas Graf" initials="T" surname="Graf">
      <organization>Swisscom</organization>

      <address>
        <postal>
          <street>Binzring 17</street>

          <city>Zurich</city>

          <code>8045</code>

          <country>Switzerland</country>
        </postal>

        <email>thomas.graf@swisscom.com</email>
      </address>
    </author>

    <author fullname="Wanting Du" initials="W" surname="Du">
      <organization>Swisscom</organization>

      <address>
        <postal>
          <street>Binzring 17</street>

          <city>Zurich</city>

          <code>8045</code>

          <country>Switzerland</country>
        </postal>

        <email>wanting.du@swisscom.com</email>
      </address>
    </author>

    <author fullname="Alex Huang Feng" initials="A." surname="Huang Feng">
      <organization>INSA-Lyon</organization>

      <address>
        <postal>
          <street/>

          <city>Lyon</city>

          <region/>

          <code/>

          <country>France</country>
        </postal>

        <phone/>

        <facsimile/>

        <email>alex.huang-feng@insa-lyon.fr</email>

        <uri/>
      </address>
    </author>

    <author fullname="Vincenzo Riccobene" initials="V." surname="Riccobene">
      <organization>Huawei</organization>

      <address>
        <postal>
          <street/>

          <city>Dublin</city>

          <region/>

          <code/>

          <country>Ireland</country>
        </postal>

        <phone/>

        <facsimile/>

        <email>vincenzo.riccobene@huawei-partners.com</email>

        <uri/>
      </address>
    </author>

    <date day="19" month="March" year="2025"/>

    <area>Operations and Management</area>

    <workgroup>NMOP</workgroup>

    <abstract>
      <t>This document explains the motivation for defining semantic
      metadata annotations to help testing, validating and comparing Outlier and
      Symptom detection systems. These semantic annotations can be supported by
      supervised and semi-supervised machine learning algorithms and enable data
      exchange among network operators, vendors and academia, making anomalies
      apprehensible for humans. The proposed semantics uniforms the network
      anomaly data exchange between operators and vendors to improve
      their Service Disruption Detection Systems.</t>
    </abstract>

    <note removeInRFC="true">
      <name>Discussion Venues</name>

      <t>Discussion of this document takes place on the Operations and
      Management Area Working Group Working Group mailing list
      (nmop@ietf.org), which is archived at <eref
      target="https://mailarchive.ietf.org/arch/browse/nmop/"/>.</t>

      <t>Source for this draft and an issue tracker can be found at <eref
      target="https://github.com/network-analytics/draft-netana-nmop-network-anomaly-semantics/"/>.</t>
    </note>
  </front>

  <middle>
    <section anchor="Introduction" title="Introduction">
      <t><xref target="I-D.ietf-nmop-network-anomaly-architecture"/>
      provides an overall introduction into how anomaly detection is
      applied to the IP network domain and which operational data are needed.
      It approaches the problem space by automating what a network engineer
      would normally do when verifying a network connectivity service, monitoring
      the different network planes to understand wherever one
      network plane affects another negatively.</t>

      <t>As a Service Disruption Detection Systems may need to be fine tuned to effectively maintain good 
      anomaly detection rates, the system need to generate analytical data that is reviewed by a network engineer.
      This process is defined in <xref target="I-D.netana-nmop-network-anomaly-lifecycle"/>, where
      the human engineer can be kept out of the monitoring process but needs to be involved in 
      the alarm verification process.</t>

      <t>This document describes what information is needed to understand the
      analytical results produced by the Service Disruption Detection System.
      The document proposes a set of semantically structured terms that can 
      be used by a Service Disription Detection System for comparing the results
      systematically, setting the baselines for supervised machine learning algorithms 
      that require labeled operational data.</t>
    </section>

    <section anchor="Conventions_and_Definitions"
             title="Conventions and Definitions">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in BCP 14
      <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when,
      they appear in all capitals, as shown here.</t>

      <section anchor="Terminology" title="Terminology">
        <t>This document makes use of the terms defined in <xref
        target="I-D.ietf-nmop-network-anomaly-architecture"/> and <xref
        target="I-D.ietf-nmop-terminology"/>.</t>

        <t>The following terms are used as defined in <xref
        target="I-D.ietf-nmop-network-anomaly-architecture"/>:</t>

        <t><list style="symbols">
            <t>Outlier Detection</t>

            <t>Service Disruption Detection</t>
      
            <t>Service Disruption Detection System</t>
          </list></t>

        <t>The following terms are used as defined in <xref
        target="I-D.ietf-nmop-terminology"/>:</t>

        <t><list style="symbols">
            <t>System</t>

            <t>State</t>

            <t>Problem</t>

            <t>Symptom</t>

            <t>Cause</t>

            <t>Alarm</t>
          </list></t>
      </section>
    </section>

    <section anchor="Observed_Symptoms" title="Observed Symptoms">
      <t>Observed network Symptoms are specified and
      categorized according to the following scheme:</t>

      <dl>
        <dt>Action:</dt>

        <dd>
          <t>Defines the operation that a network node performes when forwarding a packet
          in the Forwarding Plane, a path or adjacency event in the Control Plane or a state
          or statistical change in the Management Plane. For Forwarding Plane
          we distinguish between <strong>missing</strong>, where the packet drop occurred outside the
          measured network node, <strong>drop</strong>, where the packet drop was performed
          by the measured network node, and <strong>delay</strong>,
          which defines the on-path delay measured on
          the network node. For Control Plane we distinguish between
          <strong>reachability</strong>, which refers to a change in the routing or forwarding
          information base (RIB/FIB) and <strong>adjacency</strong> which refers to a change in
          a peering or link-layer resolution. For Management Plane we refer to
          <strong>state</strong> or <strong>statistical</strong> changes on interfaces.</t>
        </dd>
      </dl>

      <dl>
        <dt>Reason:</dt>

        <dd>
          <t>For each action, the reason describe why this action was
          performed. For drops in Forwarding Plane we distinguish between
          <strong>Unreachable</strong>, because network layer reachability information was
          missing, <strong>Administered</strong>, because an administrator configured a rule
          preventing the forwarding of this packet, and <strong>Corrupt</strong>, where the
          network node was unable to determine the forwarding path due to
          a packet, software or hardware error. For on-path delay we distinguish
          between <strong>Minimum</strong>, <strong>Average</strong> and <strong>Maximum</strong> delay
          for a given flow. For
          Control Plane, we distinguish wherever a the reachability action was due to path <strong>updates</strong> or <strong>withdraws</strong>
          or the adjacency was <strong>established</strong> or <strong>teared down</strong>. For Management
          Plane, we distinguish between interfaces states that are shown as <strong>up</strong> and <strong>down</strong>, and
          statistical counters that refer to <strong>errors</strong>, packet <strong>discards</strong> or <strong>unknown protocol</strong> counters.</t>
        </dd>
      </dl>

      <dl>
        <dt>Cause:</dt>

        <dd>
          <t>For each reason, the cause describe why a network node 
          has chosen that action.</t>
        </dd>
      </dl>

      <t><xref target="symptom_forwarding_plane_actions_table"/> consolidates
      the list of common symptoms related to the forwarding plane, defining the triplets action,
      reason and cause.</t>

      <table align="center" anchor="symptom_forwarding_plane_actions_table">
        <name slugifiedName="symptom_forwarding_plane_actions">Description of
        symptoms and their actions, reason and cause for Forwarding
        Plane</name>

        <thead>
          <tr>
            <th align="left" colspan="1" rowspan="1">Action</th>

            <th align="left" colspan="1" rowspan="1">Reason</th>

            <th align="left" colspan="1" rowspan="1">Cause</th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td align="left" colspan="1" rowspan="1">Missing</td>

            <td align="left" colspan="1" rowspan="1">Previous</td>

            <td align="left" colspan="1" rowspan="1">Time</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Unreachable</td>

            <td align="left" colspan="1" rowspan="1">next-hop</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Unreachable</td>

            <td align="left" colspan="1" rowspan="1">link-layer</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Unreachable</td>

            <td align="left" colspan="1" rowspan="1">Time To Life expired</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Unreachable</td>

            <td align="left" colspan="1" rowspan="1">Fragmentation needed and
            Don't Fragment set</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Administered</td>

            <td align="left" colspan="1" rowspan="1">Access-List</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Administered</td>

            <td align="left" colspan="1" rowspan="1">Unicast Reverse Path
            Forwarding</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Administered</td>

            <td align="left" colspan="1" rowspan="1">Discard Route</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Administered</td>

            <td align="left" colspan="1" rowspan="1">Policed</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Administered</td>

            <td align="left" colspan="1" rowspan="1">Shaped</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Corrupt</td>

            <td align="left" colspan="1" rowspan="1">Bad Packet</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Drop</td>

            <td align="left" colspan="1" rowspan="1">Corrupt</td>

            <td align="left" colspan="1" rowspan="1">Bad Egress Interface</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Delay</td>

            <td align="left" colspan="1" rowspan="1">Min</td>

            <td align="left" colspan="1" rowspan="1">-</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Delay</td>

            <td align="left" colspan="1" rowspan="1">Mean</td>

            <td align="left" colspan="1" rowspan="1">-</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Delay</td>

            <td align="left" colspan="1" rowspan="1">Max</td>

            <td align="left" colspan="1" rowspan="1">-</td>
          </tr>
        </tbody>
      </table>

      <t><xref target="symptom_control_plane_actions_table"/> consolidates
      the list of common symptoms related to control plane, describing their actions, reasons
      and causes.</t>

      <table align="center" anchor="symptom_control_plane_actions_table">
        <name slugifiedName="symptom_control_plane_actions">Description of
        symptoms and their actions, reasons and causes related to Control Plane</name>

        <thead>
          <tr>
            <th align="left" colspan="1" rowspan="1">Action</th>

            <th align="left" colspan="1" rowspan="1">Reason</th>

            <th align="left" colspan="1" rowspan="1">Cause</th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td align="left" colspan="1" rowspan="1">Reachability</td>

            <td align="left" colspan="1" rowspan="1">Update</td>

            <td align="left" colspan="1" rowspan="1">Imported</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Reachability</td>

            <td align="left" colspan="1" rowspan="1">Update</td>

            <td align="left" colspan="1" rowspan="1">Received</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Reachability</td>

            <td align="left" colspan="1" rowspan="1">Withdraw</td>

            <td align="left" colspan="1" rowspan="1">Received</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Reachability</td>

            <td align="left" colspan="1" rowspan="1">Withdraw</td>

            <td align="left" colspan="1" rowspan="1">Peer Down</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Reachability</td>

            <td align="left" colspan="1" rowspan="1">Withdraw</td>

            <td align="left" colspan="1" rowspan="1">Suppressed</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Reachability</td>

            <td align="left" colspan="1" rowspan="1">Withdraw</td>

            <td align="left" colspan="1" rowspan="1">Stale</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Reachability</td>

            <td align="left" colspan="1" rowspan="1">Withdraw</td>

            <td align="left" colspan="1" rowspan="1">Route Policy
            Filtered</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Reachability</td>

            <td align="left" colspan="1" rowspan="1">Withdraw</td>

            <td align="left" colspan="1" rowspan="1">Maximum Number of
            Prefixes Reached</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Established</td>

            <td align="left" colspan="1" rowspan="1">Peer</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Established</td>

            <td align="left" colspan="1" rowspan="1">Link-Layer</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Locally Teared Down</td>

            <td align="left" colspan="1" rowspan="1">Peer</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Remotely Teared Down</td>

            <td align="left" colspan="1" rowspan="1">Peer</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Locally Teared Down</td>

            <td align="left" colspan="1" rowspan="1">Link-Layer</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Remotely Teared Down</td>

            <td align="left" colspan="1" rowspan="1">Link-Layer</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Locally Teared Down</td>

            <td align="left" colspan="1" rowspan="1">Administrative</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Remotely Teared Down</td>

            <td align="left" colspan="1" rowspan="1">Administrative</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Locally Teared Down</td>

            <td align="left" colspan="1" rowspan="1">Maximum Number of
            Prefixes Reached</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Remotely Teared Down</td>

            <td align="left" colspan="1" rowspan="1">Maximum Number of
            Prefixes Reached</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Locally Teared Down</td>

            <td align="left" colspan="1" rowspan="1">Transport Connection
            Failed</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Adjacency</td>

            <td align="left" colspan="1" rowspan="1">Remotely Teared Down</td>

            <td align="left" colspan="1" rowspan="1">Transport Connection
            Failed</td>
          </tr>
        </tbody>
      </table>

      <t><xref target="symptom_management_plane_actions_table"/> consolidates
      the list of common symptoms related to management plane, defining the triplets action,
      reason and cause.</t>

      <table align="center" anchor="symptom_management_plane_actions_table">
        <name slugifiedName="symptom_management_plane_actions">Description of
        symptoms and their actions, reasons and causes for Management
        Plane</name>

        <thead>
          <tr>
            <th align="left" colspan="1" rowspan="1">Action</th>

            <th align="left" colspan="1" rowspan="1">Reason</th>

            <th align="left" colspan="1" rowspan="1">Cause</th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td align="left" colspan="1" rowspan="1">Interface State</td>

            <td align="left" colspan="1" rowspan="1">Up</td>

            <td align="left" colspan="1" rowspan="1">Link-Layer</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Interface State</td>

            <td align="left" colspan="1" rowspan="1">Down</td>

            <td align="left" colspan="1" rowspan="1">Link-Layer</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Interface Statistics</td>

            <td align="left" colspan="1" rowspan="1">Errors</td>

            <td align="left" colspan="1" rowspan="1">-</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Interface Statistics</td>

            <td align="left" colspan="1" rowspan="1">Discards</td>

            <td align="left" colspan="1" rowspan="1">-</td>
          </tr>

          <tr>
            <td align="left" colspan="1" rowspan="1">Interface Statistics</td>

            <td align="left" colspan="1" rowspan="1">Unknown Protocol</td>

            <td align="left" colspan="1" rowspan="1">-</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section anchor="Semantic_Metadata" title="Semantic Metadata">
      <t>Operational Metadata adds additional context to collected metrics. For instance, in a network,
      the software version of the network node defines the version of the software release that
      generated Management Plane metrics <xref
      target="I-D.claise-opsawg-collected-data-manifest"/>. Semantic
      Metadata, on the other hand, defines the meaning or ontology of the annotated data.
      In this section a YANG model is defined in order to provide a
      structure for the metadata related to anomalies occurred in a
      network. The module is intended to describe the metadata used for
      "annotating" the operational data collected from the network nodes, which
      include time series data, logs, as well as other forms of data
      that is "time-bounded". The aspects discussed in this document
      are grouped under the concept of "anomaly" which represents a collection
      of symptoms. The anomaly overall has a set of parameters that describe
      the overall behavior of the network in a given time-window including all
      the observed symptoms and outliers.</t>

      <section anchor="symptom-model-tree"
              title="Overview of the Model for the Symptom Semantic Metadata">
        <t><xref target="ietf-network-anomaly-symptom-tree"/> contains the YANG
        tree diagram <xref target="RFC8340"/> of the 'ietf-network-anomaly-symptom-cbl' module.
        It augments the 'ietf-relevant-state' module defined in <xref target="I-D.netana-nmop-network-anomaly-lifecycle"/>.</t>

        <t>For each Symptom, the following parameters can be assigned: an Action,
        a Reason and a Cause describing the Symptom; a concern score indicating how
        critical the Symptom is; and the associated network plane.</t>
        <figure anchor="ietf-network-anomaly-symptom-tree"
            title="YANG tree diagram for 'ietf-network-anomaly-symptom-cbl' module.">
        <sourcecode type="yangtree"><![CDATA[
module: ietf-network-anomaly-symptom-cbl

  augment /rsn:relevant-state/rsn:anomalies/rsn:symptom:
    +--rw action?          string
    +--rw reason?          string
    +--rw cause?           string
    +--rw network-plane?   enumeration
  augment /rsn:relevant-state-notification/rsn:anomalies/rsn:symptom:
    +-- action?          string
    +-- reason?          string
    +-- cause?           string
    +-- network-plane?   enumeration
]]></sourcecode></figure>

        <t>The module augments the anomaly of the 'relevant-state'
        container and the 'relevant-state-notification' of
        'ietf-relevant-state' module defined in <xref 
        target="I-D.netana-nmop-network-anomaly-lifecycle"/>. The 
        'relevant-state' container is used for modifying the Symptom
        data in the Postmortem system, while the
        'relevant-state-notification' is used for messaging from the
        Alarm Aggregation to the Postmortem and the Alarm and Problem
        Management system.</t>

        <t>TBD Alex: shall we remove this yang tree? It is not defined here.</t>

        <t><figure anchor="ietf-relevant-state-tree"
            title="YANG tree diagram for ietf-relevant-state">
            <artwork><![CDATA[
module: ietf-relevant-state
  +--rw relevant-state
     +--rw id                         yang:uuid
     +--rw uri?                       inet:uri
     +--rw description?               string
     +--rw start-time                 yang:date-and-time
     +--rw end-time?                  yang:date-and-time
     +--rw confidence-score?          score
     +--rw concern-score              score
     +--rw anomalies* [id revision]
     |  +--rw id                                  yang:uuid
     |  +--rw revision                            yang:counter32
     |  +--rw uri?                                inet:uri
     |  +--rw state                               identityref
     |  +--rw description?                        string
     |  +--rw start-time                          yang:date-and-time
     |  +--rw end-time?                           yang:date-and-time
     |  +--rw confidence-score?                   score
     |  +--rw pattern?                            identityref
     |  +--rw annotator
     |  |  +--rw name              string
     |  |  +--rw annotator-type?   enumeration
     |  +--rw symptom!
     |  |  +--rw id                            yang:uuid
     |  |  +--rw concern-score                 score
     |  |  +--rw smcblsymptom:action?          string
     |  |  +--rw smcblsymptom:reason?          string
     |  |  +--rw smcblsymptom:cause?           string
     |  |  +--rw smcblsymptom:network-plane?   enumeration
     |  +--rw smtopology:vpn-node-terminations*
     |          [hostname route-distinguisher]
     |     +--rw smtopology:hostname               inet:host
     |     +--rw smtopology:route-distinguisher    string
     |     +--rw smtopology:peer-ip*               inet:ip-address
     |     +--rw smtopology:next-hop*              inet:ip-address
     |     +--rw smtopology:interface-id*          uint32
     +--rw smtopology:vpn-services* [vpn-id]
        +--rw smtopology:vpn-id               string
        +--rw smtopology:uri?                 inet:uri
        +--rw smtopology:vpn-name?            string
        +--rw smtopology:site-ids*            string
        +--rw smtopology:change-id?           yang:uuid
        +--rw smtopology:change-start-time?   yang:date-and-time
        +--rw smtopology:change-end-time?     yang:date-and-time

  notifications:
    +---n relevant-state-notification
       +--ro publisher                  string
       +--ro id                         yang:uuid
       +--ro uri?                       inet:uri
       +--ro description?               string
       +--ro start-time                 yang:date-and-time
       +--ro end-time?                  yang:date-and-time
       +--ro confidence-score?          score
       +--ro concern-score              score
       +--ro anomalies* [id revision]
       |  +--ro id                                  yang:uuid
       |  +--ro revision                            yang:counter32
       |  +--ro uri?                                inet:uri
       |  +--ro state                               identityref
       |  +--ro description?                        string
       |  +--ro start-time
       |  |       yang:date-and-time
       |  +--ro end-time?
       |  |       yang:date-and-time
       |  +--ro confidence-score?                   score
       |  +--ro pattern?                            identityref
       |  +--ro annotator
       |  |  +--ro name              string
       |  |  +--ro annotator-type?   enumeration
       |  +--ro symptom!
       |  |  +--ro id                            yang:uuid
       |  |  +--ro concern-score                 score
       |  |  +--ro smcblsymptom:action?          string
       |  |  +--ro smcblsymptom:reason?          string
       |  |  +--ro smcblsymptom:cause?           string
       |  |  +--ro smcblsymptom:network-plane?   enumeration
       |  +--ro smtopology:vpn-node-terminations*
       |          [hostname route-distinguisher]
       |     +--ro smtopology:hostname               inet:host
       |     +--ro smtopology:route-distinguisher    string
       |     +--ro smtopology:peer-ip*               inet:ip-address
       |     +--ro smtopology:next-hop*              inet:ip-address
       |     +--ro smtopology:interface-id*          uint32
       +--ro smtopology:vpn-services* [vpn-id]
          +--ro smtopology:vpn-id               string
          +--ro smtopology:uri?                 inet:uri
          +--ro smtopology:vpn-name?            string
          +--ro smtopology:site-ids*            string
          +--ro smtopology:change-id?           yang:uuid
          +--ro smtopology:change-start-time?   yang:date-and-time
          +--ro smtopology:change-end-time?     yang:date-and-time
      ]]></artwork>
          </figure></t>
      </section>		
    
      <section anchor="YANG-Symptom-Module" title="YANG Module 'ietf-network-anomaly-symptom-cbl'">
        <t>The YANG module has one typedef defining the score, a grouping
        defining Action, Reason and Cause and how symptom attributes to the
        network planes.</t>

<sourcecode name="ietf-network-anomaly-symptom-cbl@2025-03-19.yang" type="yang" markers="true"><![CDATA[
module ietf-network-anomaly-symptom-cbl {
  yang-version 1.1;
  namespace
    "urn:ietf:params:xml:ns:yang:ietf-network-anomaly-symptom-cbl";
  prefix smcblsymptom;

  import ietf-relevant-state {
    prefix rsn;
    reference
      "RFC XXX: Relevant State and Relevant State Notification";
  }

  organization
    "IETF NMOP (Network Management Operations) Working Group";
  contact
    "WG Web:   <http:/tools.ietf.org/wg/netconf/>
     WG List:  <mailto:nmop@ietf.org>

     Editor:   Thomas Graf
               <mailto:thomas.graf@swisscom.com>
               Wanting Du
               <mailto:wanting.du@swisscom.com>
               Alex Huang Feng
               <mailto:alex.huang-feng@insa-lyon.fr>
               Vincenzo Riccobene
               <mailto:vincenzo.riccobene@huawei-partners.com>";
  description
    "This module defines the semantic grouping to be used by a
     Service Disruption Detection Systems. The defined objects is
     used to augment the anomaly container. Describing the
     symptoms action, reason and concern-score.

     Copyright (c) 2025 IETF Trust and the persons
     identified as authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Revised BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     All revisions of IETF and IANA published modules can be found
     at the YANG Parameters registry
     (https://www.iana.org/assignments/yang-parameters).

     This version of this YANG module is part of RFC XXXX; see
     the RFC itself for full legal notices.";

  revision 2025-03-19 {
    description
      "Initial version";
    reference
      "RFC XXX: Semantic Metadata Annotation for Network Anomaly
       Detection";
  }

  typedef score {
    type uint8 {
      range "0..100";
    }
    description
      "Number indicating a score between 0 and 100.";
  }

  grouping cbl-symptom {
    description
      "Semantic metadata assocaited to a symptom for a detected
       connectivity service anomaly.";
    leaf action {
      type string;
      description
        "Operation performed by a network node when forwarding a
         packet.";
    }
    leaf reason {
      type string;
      description
        "Reason associated to the action performed by the network
         node.";
    }
    leaf cause {
      type string;
      description
        "Describes why the network node chose this action.";
    }
    leaf network-plane {
      type enumeration {
        enum forwarding {
          description
            "Symptom associated to the Forwarding Plane.";
        }
        enum control {
          description
            "Symptom associated to the Control Plane.";
        }
        enum management {
          description
            "Symptom associated to the Management Plane.";
        }
      }
      description
        "Associated network plane.";
    }
  }

  augment "/rsn:relevant-state/rsn:anomalies"
        + "/rsn:symptom" {
    description
      "Provide extension for the symptom description,
       specifically for connectivity services to the
       relevant state container";
    uses cbl-symptom;
  }

  augment "/rsn:relevant-state-notification/rsn:anomalies"
        + "/rsn:symptom" {
    description
      "Provide extension for the symptom description,
       specifically for connectivity services to the
       relevant state notification";
    uses cbl-symptom;
  }
}
]]></sourcecode>
      </section>

      <section anchor="YANG-Service-Topology-Module" title="YANG Module 'ietf-network-anomaly-service-topology'">
        <t>The YANG module has a service and a node-termination grouping
        defining a 'vpn-id', a 'vpn-name' and 'site-ids' for service and hostname, 
        BGP route-distinguisher, BGP peer ip address, BGP path next-hop and node 
        interface-id.</t>

        <t>Within the NMOP working group we discuss with the Digital Map authors
        which existing YANG nodes instead could be used to facilitate a service
        and network topology context view.</t>

<sourcecode name="ietf-network-anomaly-service-topology@2025-03-19.yang" type="yang" markers="true"><![CDATA[
module ietf-network-anomaly-service-topology {
  yang-version 1.1;
  namespace
    "urn:ietf:params:xml:ns:yang:ietf-network-anomaly-service-topology";
  prefix smtopology;

  import ietf-inet-types {
    prefix inet;
    reference
      "RFC 6991: Common YANG Data Types";
  }
  import ietf-yang-types {
    prefix yang;
    reference
      "RFC 6991: Common YANG Data Types";
  }
  import ietf-relevant-state {
    prefix rsn;
    reference
      "RFC XXX: An Experiment: Network Anomaly Lifecycle";
  }

  organization
    "IETF NMOP (Network Management Operations) Working Group";
  contact
    "WG Web:   <http:/tools.ietf.org/wg/netconf/>
     WG List:  <mailto:nmop@ietf.org>

     Editor:   Thomas Graf
               <mailto:thomas.graf@swisscom.com>
               Wanting Du
               <mailto:wanting.du@swisscom.com>
               Alex Huang Feng
               <mailto:alex.huang-feng@insa-lyon.fr>
               Vincenzo Riccobene
               <mailto:vincenzo.riccobene@huawei-partners.com>";
  description
    "This module defines the symptom container to be used by a network
     anomaly detection system. The defined objects can be used to
     augment operational network collected observability data and
     analytical problem data equally. Describing the relevant-state
     of observed symptoms.

     Copyright (c) 2025 IETF Trust and the persons
     identified as authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Revised BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     All revisions of IETF and IANA published modules can be found
     at the YANG Parameters registry
     (https://www.iana.org/assignments/yang-parameters).

     This version of this YANG module is part of RFC XXXX; see
     the RFC itself for full legal notices.";

  revision 2025-03-19 {
    description
      "Initial version";
    reference
      "RFC XXX: Semantic Metadata Annotation for Network Anomaly Detection";
  }

  grouping vpn-services {
    description
      "Connectivity service of type VPN. This grouping is
       used to augment the relevant-state container.";
    list vpn-services {
      key "vpn-id";
      description
        "List of VPN services of interest.";
      leaf vpn-id {
        type string;
        mandatory true;
        description
          "Unique ID of the VPN connectivity service.";
      }
      leaf uri {
        type inet:uri;
        description
          "URI to viusalize the VPN service inventory.";
      }
      leaf vpn-name {
        type string;
        description
          "Name of the VPN connectivity service.";
      }
      leaf-list site-ids {
        type string;
        description
          "List of unique site ID's of the VPN connectivity service.";
      }
      leaf change-id {
        type yang:uuid;
        description
          "Unique identifier of VPN service maintenance window.";
      }
      leaf change-start-time {
        type yang:date-and-time;
        description
          "Start date and time of the VPN service maintenance window.";
      }
      leaf change-end-time {
        type yang:date-and-time;
        description
          "End date and time of the VPN service maintenance window.";
      }
    }
  }

  grouping vpn-node-termination {
    description
      "Node Termination for the VPN Service instance.
       This grouping is used to augment the relevant-state container.";
    list vpn-node-terminations {
      key "hostname route-distinguisher";
      description
        "List of Node Terminations of interest.";
      leaf hostname {
        type inet:host;
        mandatory true;
        description
          "The hostname of the network node according to
            [RFC1213]. This value is usually configured on
            the node by the administrator to uniquely
            identify the node in the network.";
      }
      leaf route-distinguisher {
        type string;
        mandatory true;
        description
          "The BGP route-distinguisher obtained through
            IPFIX IE90 mplsVpnRouteDistinguisher or BMP
            route-monitoring or peer_up message type.";
      }
      leaf-list peer-ip {
        type inet:ip-address;
        description
          "The BGP peering IP address learned through
            BMP route-monitoring, peer_up or peer_down
            message type.";
      }
      leaf-list next-hop {
        type inet:ip-address;
        description
          "The BGP next-hop IP address learned through
            BMP route-monitoring message type.";
      }
      leaf-list interface-id {
        type uint32;
        description
          "The interface identifier obtained through
            IPFIX IE10 ingressInterface, IE14
            egressInterface or
            ietf-interfaces:interfaces/interface/if-index.";
      }
    }
  }

  augment "/rsn:relevant-state" {
    description
      "Provide extension for the service description,
       specifically for connectivity services to the
       relevant state container.";
    uses vpn-services;
  }

  augment "/rsn:relevant-state-notification" {
    description
      "Provide extension for the service description,
       specifically for connectivity services to the
       relevant state notification.";
    uses vpn-services;
  }

  augment "/rsn:relevant-state/rsn:anomalies" {
    description
      "Provide extension for the service description,
       specifically for connectivity services to the
       relevant state container.";
    uses vpn-node-termination;
  }

  augment "/rsn:relevant-state-notification/rsn:anomalies" {
    description
      "Provide extension for the service description,
       specifically for connectivity services to the
       relevant state notification.";
    uses vpn-node-termination;
  }
}
]]></sourcecode>
      </section>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>TBD https://datatracker.ietf.org/doc/html/draft-ietf-netmod-rfc8407bis-22#name-security-considerations-sect.</t>
    </section>

    <section anchor="Implementation" title="Implementation status">
      <t>This section provides pointers to existing open source
      implementations of this draft. Note to the RFC-editor: Please remove
      this before publishing.</t>

      <section anchor="Implementation-Antagonist" title="Antagonist">
        <t>A tool called Antagonist has been implemented and refined during
        the IETF 119 and 120 hackathons, in order to validate the application
        of the YANG models defined in this draft. Antagonist provides visual
        support for two important use cases in the scope of this document:</t>
    
        <ul>
          <li>the generation of a ground truth in relation to Symptoms and
          Problems in timeseries data</li>

          <li>the visual validation of results produced by automated network
          anomaly detection tools.</li>
        </ul>
    
        <t>The open source code can be found here: <xref target="Antagonist"/></t>
      </section>
    </section>

    <section anchor="Acknowledgements" title="Acknowledgements">
      <t>The authors would like to thank ,  for his review and
      valuable comment.</t>

      <t>The authors would like to thank Antonio Roberto for his contribution
         to the ideas in this draft and Reshad Rahman and Mohamed Boucadair for his review
         and valuable comments.</t>

    </section>
  </middle>

  <back>
    <references title="Normative References">
      <?rfc include='https://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml'?>

      <?rfc include='https://xml.resource.org/public/rfc/bibxml/reference.RFC.8174.xml'?>

      <?rfc include='https://xml.resource.org/public/rfc/bibxml/reference.RFC.8340.xml'?>

      <?rfc include='https://bib.ietf.org/public/rfc/bibxml-ids/reference.I-D.ietf-nmop-terminology.xml'?>

      <?rfc include='https://bib.ietf.org/public/rfc/bibxml-ids/reference.I-D.ietf-nmop-network-anomaly-architecture.xml'?>

      <?rfc include='https://bib.ietf.org/public/rfc/bibxml-ids/reference.I-D.netana-nmop-network-anomaly-lifecycle.xml'?>

      <reference anchor="Antagonist"
                 target="https://github.com/vriccobene/antagonist">
        <front>
          <title>Antagonist: Anomaly tagging on historical data</title>

          <author fullname="Vincenzo Riccobene" initials="V."
                  surname="Riccobene"/>

          <author fullname="Wanting Du" initials="W." surname="Du"/>

          <author fullname="Thomas Graf" initials="T." surname="Graf"/>

          <author fullname="Alex Huang Feng" initials="H."
                  surname="Huang Feng"/>
        </front>
      </reference>
    </references>

    <references title="Informative References">
      <?rfc include='https://bib.ietf.org/public/rfc/bibxml-ids/reference.I-D.claise-opsawg-collected-data-manifest.xml'?>
    </references>
  </back>
</rfc>
